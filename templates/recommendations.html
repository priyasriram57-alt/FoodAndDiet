{% extends "base.html" %}

{% block title %}Recommendations - FoodAI{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<style>
    .filter-card {
        border: none;
        border-radius: 1rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
    }
    .page-header-simple {
        background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
        border-radius: 1rem;
        padding: 2rem;
        color: white;
        margin-bottom: 2rem;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        position: relative;
        overflow: hidden;
    }
    .page-header-simple::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
        opacity: 0.6;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid px-4 md:px-5 py-4">
    <!-- Header Banner -->
    <div class="page-header-simple d-flex justify-content-between align-items-center mb-4">
        <div class="position-relative" style="z-index: 2;">
            <h2 class="fw-bold mb-1 text-white">Food Recommendations</h2>
            <p class="mb-0 text-white-50">Discover healthy and delicious meals tailored to your goals</p>
        </div>
        <div class="d-none d-md-block opacity-50 position-relative" style="z-index: 2;">
            <i class="fas fa-utensils fa-3x text-white"></i>
        </div>
    </div>

    <!-- Filter Section -->
    <div class="card filter-card mb-5">
        <div class="card-body p-4">
            <h5 class="card-title fw-bold text-secondary mb-4"><i class="fas fa-sliders-h me-2 text-primary"></i> Filter Options</h5>
            
            <div class="row g-4 align-items-end">
                <div class="col-md-3">
                    <label class="form-label text-xs fw-bold text-uppercase text-muted small">Meal Type</label>
                    <div class="input-group">
                        <span class="input-group-text bg-white border-end-0"><i class="fas fa-clock text-muted"></i></span>
                        <select class="form-select bg-white border-start-0 ps-0" id="recommendationMealType">
                            <option value="all">All Meals</option>
                            <option value="breakfast">Breakfast</option>
                            <option value="lunch">Lunch</option>
                            <option value="dinner">Dinner</option>
                            <option value="snack">Snacks</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3">
                    <label class="form-label text-xs fw-bold text-uppercase text-muted small">Category</label>
                    <div class="input-group">
                        <span class="input-group-text bg-white border-end-0"><i class="fas fa-tags text-muted"></i></span>
                        <select class="form-select bg-white border-start-0 ps-0" id="recommendationCategory">
                            <option value="all">All Categories</option>
                            <option value="Breakfast">Breakfast</option>
                            <option value="Lunch">Lunch</option>
                            <option value="Dinner">Dinner</option>
                            <option value="Salad">Salad</option>
                            <option value="Soup">Soup</option>
                            <option value="Dessert">Dessert</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3">
                    <label class="form-label text-xs fw-bold text-uppercase text-muted small">Cuisine</label>
                    <div class="input-group">
                        <span class="input-group-text bg-white border-end-0"><i class="fas fa-globe text-muted"></i></span>
                        <select class="form-select bg-white border-start-0 ps-0" id="recommendationCuisine">
                            <option value="all">All Cuisines</option>
                            <option value="Italian">Italian</option>
                            <option value="Indian">Indian</option>
                            <option value="Chinese">Chinese</option>
                            <option value="Mexican">Mexican</option>
                            <option value="Mediterranean">Mediterranean</option>
                        </select>
                    </div>
                </div>
                <!-- Hidden Sort for Logic -->
                <select class="d-none" id="recommendationSort">
                    <option value="score">Recommendation Score</option>
                    <option value="calories">Calories (Low to High)</option>
                    <option value="protein">Protein (High to Low)</option>
                    <option value="health">Health Score</option>
                </select>

                <div class="col-md-3">
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary w-100 rounded-pill shadow-sm py-2" id="getRecommendationsBtn">
                            <i class="fas fa-search me-2"></i> Find
                        </button>
                        <button class="btn btn-light rounded-circle shadow-sm" id="refreshRecommendations" title="Reset Filters" style="width: 42px; height: 42px;">
                            <i class="fas fa-sync-alt text-muted"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Results Section -->
    <div id="recommendationsContainer" class="row g-4">
        <!-- Default State -->
        <div class="col-12 py-5 text-center">
            <div class="mb-4 text-muted opacity-25">
                <i class="fas fa-search fa-4x"></i>
            </div>
            <h4 class="text-secondary fw-normal">Ready to explore?</h4>
            <p class="text-muted">Use the filters above to find your perfect meal.</p>
        </div>
    </div>

    <!-- Hidden Stats Section (shows up after search) -->
    <div class="mt-5" id="recommendationStats" style="display: none;">
        <h5 class="fw-bold mb-3 ms-1 text-secondary">Analysis</h5>
        <div class="row g-3" id="statsContent">
            <!-- Stats populated by JS -->
        </div>
    </div>
    
    <!-- Recently Viewed & Favorites Row -->
    <div class="row mt-5 g-4">
        <div class="col-lg-6">
            <div class="card h-100 border-0 shadow-sm" style="border-radius: 1rem;">
                <div class="card-header bg-transparent border-0 py-3">
                    <h5 class="mb-0 fw-bold"><i class="fas fa-history me-2 text-info"></i> Recently Viewed</h5>
                </div>
                <div class="card-body">
                    <div id="recentlyViewed" class="list-group list-group-flush">
                        <div class="text-center py-4 text-muted">
                            <small>No items viewed yet</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card h-100 border-0 shadow-sm" style="border-radius: 1rem;">
                <div class="card-header bg-transparent border-0 py-3">
                    <h5 class="mb-0 fw-bold"><i class="fas fa-heart me-2 text-danger"></i> Your Favorites</h5>
                </div>
                <div class="card-body">
                    <div id="favoriteFoods" class="list-group list-group-flush">
                        <!-- Populated by JS -->
                        <div class="text-center py-4 text-muted">
                            <small>No favorites saved yet</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
